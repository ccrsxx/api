#!/bin/sh

# The exact commit message your npm script uses.
BOT_COMMIT_MSG="docs(api): update OpenAPI spec"

# Get the subject line of the most recent commit.
LAST_COMMIT_MSG=$(git log -1 --pretty=%s)

# Check if the last commit was made by the bot.
if [ "$LAST_COMMIT_MSG" = "$BOT_COMMIT_MSG" ]; then
  # If it was, print a message and exit successfully to prevent a loop.
  echo "‚Ü©Ô∏è Last commit was an auto-update. Skipping hook."
  exit 0
else
  # If it was a manual commit, run the generator script.
  echo "üöÄ Post-commit hook: Running OpenAPI generator..."
  npm run openapi:generate
fi
